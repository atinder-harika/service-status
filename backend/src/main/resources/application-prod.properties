# Production profile - Used by Railway
# Railway env vars: DATABASE_URL, DB_USER, DB_PASSWORD, SPRING_PROFILES_ACTIVE=prod

# PostgreSQL Connection (Railway provides these as env vars)
spring.datasource.url=${DATABASE_URL}&prepareThreshold=0
spring.datasource.username=${DB_USER}
spring.datasource.password=${DB_PASSWORD}
spring.datasource.driver-class-name=org.postgresql.Driver

# Flyway Configuration (creates 'prod' schema in your Supabase)
spring.flyway.enabled=true
spring.flyway.locations=classpath:db/migration
spring.flyway.baseline-on-migrate=true
spring.flyway.schemas=prod
spring.flyway.default-schema=prod

# Production settings
spring.datasource.hikari.schema=prod
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.connection-timeout=20000

# Fix for Supabase/PgBouncer "prepared statement already exists" error
# Disables server-side prepared statements to avoid collisions in transaction pooling
spring.datasource.hikari.data-source-properties.prepareThreshold=0

# Disable debug logging in production
logging.level.com.atinder.service_status_backend=INFO
logging.level.org.springframework.jdbc.core=WARN
